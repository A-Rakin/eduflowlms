{% extends "base.html" %}

{% block title %}Manage {{ course.title }}{% endblock %}

{% block content %}
<h1>Manage Course: {{ course.title }}</h1>

<div class="row">
    <div class="col-md-8">
        <h3>Course Modules</h3>

        <div class="list-group mb-4">
            {% for module in course.modules|sort(attribute='order') %}
                <div class="list-group-item">
                    <div class="d-flex justify-content-between align-items-center">
                        <h5>{{ module.title }}</h5>
                        <span class="badge bg-primary">Order: {{ module.order }}</span>
                    </div>
                    <p>{{ module.description }}</p>

                    <div class="mt-3">
                        <a href="{{ url_for('add_content', module_id=module.id) }}" class="btn btn-sm btn-success">Add Content</a>
                        <a href="{{ url_for('add_quiz', module_id=module.id) }}" class="btn btn-sm btn-warning">Add Quiz</a>
                        <a href="{{ url_for('add_assignment', module_id=module.id) }}" class="btn btn-sm btn-info">Add Assignment</a>
                    </div>

                    {% if module.contents %}
                        <h6 class="mt-3">Contents:</h6>
                        <ul class="list-unstyled">
                            {% for content in module.contents|sort(attribute='order') %}
                                <li class="mb-2">
                                    <span class="badge bg-secondary">{{ content.content_type }}</span>
                                    {{ content.title }}
                                </li>
                            {% endfor %}
                        </ul>
                    {% endif %}
                </div>
            {% endfor %}
        </div>

        <a href="{{ url_for('add_module', course_id=course.id) }}" class="btn btn-primary">Add New Module</a>
    </div>

    <div class="col-md-4">
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Quick Actions</h5>
                <div class="d-grid gap-2">
                    <a href="{{ url_for('view_course', course_id=course.id) }}" class="btn btn-outline-primary">View Course</a>
                    <a href="#" class="btn btn-outline-danger">Delete Course</a>
                </div>
            </div>
        </div>

        <div class="card mt-3">
            <div class="card-body">
                <h5 class="card-title">Course Stats</h5>
                <p><strong>Modules:</strong> {{ course.modules|length }}</p>
                <p><strong>Enrolled Students:</strong> {{ course.enrollments|length }}</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}